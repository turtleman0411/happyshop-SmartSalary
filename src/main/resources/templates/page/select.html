<!DOCTYPE html>
<html lang="zh" xmlns:th="http://www.thymeleaf.org">
<head th:replace="~{layout/head :: head('設定分類｜HappyShop', 'select.css')}"></head>

<body class="select">

<div th:replace="~{layout/navbar :: navbar(@{/happyshop/home})}"></div>

<div th:replace="~{layout/month-bar :: monthBar(
  baseUrl='/happyshop/select',
  month=${view.month}, themeClass=${themeClass != null ? themeClass : ''})}"></div>

<main class="hs-select-bg">
  <div class="hs-main">

    <header class="hs-select-head">
  <h1>📊 設定本月分類</h1>
  <p th:text="|${view.month} 的預算比例設定|"></p>

    <form id="categoryForm"
          th:action="@{/happyshop/select}"
          method="post">

      <input type="hidden" name="month" th:value="${view.month}"/>

      <!-- 分類群組 -->
      <section th:each="entry : ${view.groupedCategories}"
               class="hs-group">

        <h2 class="hs-group-title" th:text="${entry.key}"></h2>

        <div class="hs-card-list">
          <label class="hs-cat-card"
                 th:each="cat : ${entry.value}">

            <input type="checkbox"
                   class="cat-check"
                   th:name="'enabled[' + ${cat.categoryName()} + ']'"
                   th:value="true"/>

            <div class="hs-cat-inner">

              <!-- 左側狀態條（CSS 畫） -->

              <div class="hs-cat-main">
                <span class="hs-cat-name"
                      th:text="${cat.categoryDisplayName()}"></span>

                <!-- 第二感知：icon -->
                <span class="hs-cat-checkmark" aria-label="已設定">✔</span>
              </div>

              <input type="number"
                     class="hs-cat-input"
                     th:name="'percents[' + ${cat.categoryName()} + ']'"
                     th:value="${cat.percent()}"
                     min="0" max="100" step="1"
                     placeholder="%"
                     disabled/>
            </div>

          </label>
        </div>
      </section>

      <footer class="hs-select-foot">
        <div class="hs-total">
          已分配：<strong id="percentTotal">0%</strong>
        </div>

        <div class="hs-actions">
          <a th:href="@{/happyshop/home}" class="hs-btn ghost">取消</a>
          <button type="submit" id="submitBtn" class="hs-btn primary" disabled>
            下一步
          </button>
        </div>
      </footer>

    </form>
  </div>
</main>

<script src="/js/select-category.js" defer></script>

</body>
</html>
